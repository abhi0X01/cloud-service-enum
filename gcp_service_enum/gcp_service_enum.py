import requests
import google.oauth2.credentials
from googleapiclient.discovery import build
import pprint
from datetime import datetime
import json
import argparse
from argparse import RawTextHelpFormatter
from termcolor import colored
import sys
import os

parser = argparse.ArgumentParser(formatter_class=RawTextHelpFormatter,description="""
< GCP_SERVICE_ENUM Says "Hello, world!" >
 ---------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/
                ||----w |
                ||     ||

""")
optional = parser._action_groups.pop()
required = parser.add_argument_group('required arguments')
required.add_argument("--access-token",  metavar='\b', required=True,help="GCP oauth Access Token")
optional.add_argument("--region", metavar='\b', help='''\
Enter any value from given list 
ap-northeast-1, ap-northeast-2, ap-northeast-3, ap-southeast-1, ap-southeast-2, ap-south-1
ca-central-1
eu-central-1, eu-west-1, eu-west-2, eu-west-3, eu-north-1
us-east-1, us-east-2, us-west-1, us-west-2
sa-east-1''')
optional.add_argument("--project-id", metavar='\b', help='ProjectID. Fetch from http://metadata.google.internal/computeMetadata/v1beta1/project/project-id endpoint')
optional.add_argument('--verbose', action='store_true', help="Select for Verbose output")
optional.add_argument('--logs',  action='store_true',help="Create a log File in same directory")
parser._action_groups.append(optional)
parser.parse_args(args=None if sys.argv[1:] else ['--help'])
args = parser.parse_args()

headers={"Authorization":"Bearer "+args.access_token}

d={u'websecurityscanner': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1alpha', u'v1beta']}, u'abusiveexperiencereport': {'scopes': [u'https://www.googleapis.com/auth/xapi.zoo'], 'version': [u'v1']}, u'tasks': {'scopes': [u'https://www.googleapis.com/auth/tasks', u'https://www.googleapis.com/auth/tasks.readonly'], 'version': [u'v1']}, u'androidenterprise': {'scopes': [u'https://www.googleapis.com/auth/androidenterprise'], 'version': [u'v1']}, u'firebaserules': {'scopes': [u'https://www.googleapis.com/auth/firebase', u'https://www.googleapis.com/auth/cloud-platform', u'https://www.googleapis.com/auth/firebase.readonly'], 'version': [u'v1']}, u'siteVerification': {'scopes': [u'https://www.googleapis.com/auth/siteverification', u'https://www.googleapis.com/auth/siteverification.verify_only'], 'version': [u'v1']}, u'oslogin': {'scopes': [u'https://www.googleapis.com/auth/compute', u'https://www.googleapis.com/auth/cloud-platform', u'https://www.googleapis.com/auth/compute.readonly', u'https://www.googleapis.com/auth/cloud-platform.read-only'], 'version': [u'v1alpha', u'v1beta', u'v1']}, u'adsense': {'scopes': [u'https://www.googleapis.com/auth/adsense.readonly', u'https://www.googleapis.com/auth/adsense'], 'version': [u'v1.4']}, u'playcustomapp': {'scopes': [u'https://www.googleapis.com/auth/androidpublisher'], 'version': [u'v1']}, u'servicemanagement': {'scopes': [u'https://www.googleapis.com/auth/service.management.readonly', u'https://www.googleapis.com/auth/cloud-platform', u'https://www.googleapis.com/auth/service.management', u'https://www.googleapis.com/auth/cloud-platform.read-only'], 'version': [u'v1']}, u'pubsub': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform', u'https://www.googleapis.com/auth/pubsub'], 'version': [u'v1beta1a', u'v1', u'v1beta2']}, u'libraryagent': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1']}, u'bigtableadmin': {'scopes': [u'https://www.googleapis.com/auth/cloud-bigtable.admin', u'https://www.googleapis.com/auth/bigtable.admin', u'https://www.googleapis.com/auth/cloud-platform.read-only', u'https://www.googleapis.com/auth/cloud-platform', u'https://www.googleapis.com/auth/cloud-bigtable.admin.table', u'https://www.googleapis.com/auth/bigtable.admin.cluster', u'https://www.googleapis.com/auth/cloud-bigtable.admin.cluster', u'https://www.googleapis.com/auth/bigtable.admin.table', u'https://www.googleapis.com/auth/bigtable.admin.instance'], 'version': [u'v1', u'v2']}, u'docs': {'scopes': [u'https://www.googleapis.com/auth/drive', u'https://www.googleapis.com/auth/documents.readonly', u'https://www.googleapis.com/auth/drive.readonly', u'https://www.googleapis.com/auth/documents', u'https://www.googleapis.com/auth/drive.file'], 'version': [u'v1']}, u'streetviewpublish': {'scopes': [u'https://www.googleapis.com/auth/streetviewpublish'], 'version': [u'v1']}, u'indexing': {'scopes': [u'https://www.googleapis.com/auth/indexing'], 'version': [u'v3']}, u'bigquerydatatransfer': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform', u'https://www.googleapis.com/auth/bigquery', u'https://www.googleapis.com/auth/cloud-platform.read-only'], 'version': [u'v1']}, u'spanner': {'scopes': [u'https://www.googleapis.com/auth/spanner.admin', u'https://www.googleapis.com/auth/spanner.data', u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1']}, u'appstate': {'scopes': [u'https://www.googleapis.com/auth/appstate'], 'version': [u'v1']}, u'cloudprivatecatalogproducer': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1beta1']}, u'accesscontextmanager': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1beta', u'v1']}, u'digitalassetlinks': {'scopes': [], 'version': [u'v1']}, u'androidmanagement': {'scopes': [u'https://www.googleapis.com/auth/androidmanagement'], 'version': [u'v1']}, u'fitness': {'scopes': [u'https://www.googleapis.com/auth/fitness.body.read', u'https://www.googleapis.com/auth/fitness.reproductive_health.read', u'https://www.googleapis.com/auth/fitness.body_temperature.write', u'https://www.googleapis.com/auth/fitness.body.write', u'https://www.googleapis.com/auth/fitness.activity.read', u'https://www.googleapis.com/auth/fitness.location.read', u'https://www.googleapis.com/auth/fitness.blood_pressure.write', u'https://www.googleapis.com/auth/fitness.body_temperature.read', u'https://www.googleapis.com/auth/fitness.oxygen_saturation.write', u'https://www.googleapis.com/auth/fitness.nutrition.write', u'https://www.googleapis.com/auth/fitness.reproductive_health.write', u'https://www.googleapis.com/auth/fitness.activity.write', u'https://www.googleapis.com/auth/fitness.blood_glucose.write', u'https://www.googleapis.com/auth/fitness.oxygen_saturation.read', u'https://www.googleapis.com/auth/fitness.nutrition.read', u'https://www.googleapis.com/auth/fitness.blood_glucose.read', u'https://www.googleapis.com/auth/fitness.blood_pressure.read', u'https://www.googleapis.com/auth/fitness.location.write'], 'version': [u'v1']}, u'discovery': {'scopes': [], 'version': [u'v1']}, u'vision': {'scopes': [u'https://www.googleapis.com/auth/cloud-vision', u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1p1beta1', u'v1p2beta1', u'v1']}, u'youtubereporting': {'scopes': [u'https://www.googleapis.com/auth/yt-analytics.readonly', u'https://www.googleapis.com/auth/yt-analytics-monetary.readonly'], 'version': [u'v1']}, u'webmasters': {'scopes': [u'https://www.googleapis.com/auth/webmasters.readonly', u'https://www.googleapis.com/auth/webmasters'], 'version': [u'v3']}, u'people': {'scopes': [u'https://www.googleapis.com/auth/user.birthday.read', u'https://www.googleapis.com/auth/contacts.readonly', u'https://www.googleapis.com/auth/user.emails.read', u'https://www.googleapis.com/auth/user.addresses.read', u'https://www.googleapis.com/auth/contacts', u'https://www.googleapis.com/auth/userinfo.email', u'https://www.googleapis.com/auth/userinfo.profile', u'https://www.googleapis.com/auth/user.phonenumbers.read'], 'version': [u'v1']}, u'runtimeconfig': {'scopes': [u'https://www.googleapis.com/auth/cloudruntimeconfig', u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1', u'v1beta1']}, u'alertcenter': {'scopes': [u'https://www.googleapis.com/auth/apps.alerts'], 'version': [u'v1beta1']}, u'dfareporting': {'scopes': [u'https://www.googleapis.com/auth/dfatrafficking', u'https://www.googleapis.com/auth/dfareporting', u'https://www.googleapis.com/auth/ddmconversions'], 'version': [u'v3.1', u'v3.2', u'v3.3']}, u'cloudbilling': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1']}, u'analytics': {'scopes': [u'https://www.googleapis.com/auth/analytics', u'https://www.googleapis.com/auth/analytics.readonly', u'https://www.googleapis.com/auth/analytics.provision', u'https://www.googleapis.com/auth/analytics.manage.users.readonly', u'https://www.googleapis.com/auth/analytics.user.deletion', u'https://www.googleapis.com/auth/analytics.manage.users', u'https://www.googleapis.com/auth/analytics.edit'], 'version': [u'v2.4', u'v3']}, u'books': {'scopes': [u'https://www.googleapis.com/auth/books'], 'version': [u'v1']}, u'cloudresourcemanager': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform', u'https://www.googleapis.com/auth/cloud-platform.read-only'], 'version': [u'v1', u'v1beta1', u'v2', u'v2beta1']}, u'mirror': {'scopes': [u'https://www.googleapis.com/auth/glass.timeline', u'https://www.googleapis.com/auth/glass.location'], 'version': [u'v1']}, u'cloudidentity': {'scopes': [u'https://www.googleapis.com/auth/cloud-identity.groups.readonly', u'https://www.googleapis.com/auth/cloud-identity.groups'], 'version': [u'v1', u'v1beta1']}, u'cloudtasks': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v2', u'v2beta2', u'v2beta3']}, u'calendar': {'scopes': [u'https://www.googleapis.com/auth/calendar.settings.readonly', u'https://www.googleapis.com/auth/calendar.events.readonly', u'https://www.googleapis.com/auth/calendar', u'https://www.googleapis.com/auth/calendar.readonly', u'https://www.googleapis.com/auth/calendar.events'], 'version': [u'v3']}, u'gmail': {'scopes': [u'https://www.googleapis.com/auth/gmail.settings.basic', u'https://mail.google.com/', u'https://www.googleapis.com/auth/gmail.send', u'https://www.googleapis.com/auth/gmail.compose', u'https://www.googleapis.com/auth/gmail.metadata', u'https://www.googleapis.com/auth/gmail.settings.sharing', u'https://www.googleapis.com/auth/gmail.labels', u'https://www.googleapis.com/auth/gmail.readonly', u'https://www.googleapis.com/auth/gmail.insert', u'https://www.googleapis.com/auth/gmail.modify'], 'version': [u'v1']}, u'container': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1', u'v1beta1']}, u'kgsearch': {'scopes': [], 'version': [u'v1']}, u'serviceconsumermanagement': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1']}, u'cloudiot': {'scopes': [u'https://www.googleapis.com/auth/cloudiot', u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1alpha1', u'v1']}, u'redis': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1', u'v1beta1']}, u'content': {'scopes': [u'https://www.googleapis.com/auth/content'], 'version': [u'v2', u'v2.1']}, u'dialogflow': {'scopes': [u'https://www.googleapis.com/auth/dialogflow', u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v2', u'v2beta1']}, u'dlp': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v2']}, u'run': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1alpha1', u'v1']}, u'remotebuildexecution': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1alpha', u'v1', u'v2']}, u'firebasedynamiclinks': {'scopes': [u'https://www.googleapis.com/auth/firebase'], 'version': [u'v1']}, u'firebasehosting': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform', u'https://www.googleapis.com/auth/firebase.readonly', u'https://www.googleapis.com/auth/firebase', u'https://www.googleapis.com/auth/cloud-platform.read-only'], 'version': [u'v1beta1']}, u'jobs': {'scopes': [u'https://www.googleapis.com/auth/jobs', u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v3p1beta1', u'v2', u'v3']}, u'surveys': {'scopes': [u'https://www.googleapis.com/auth/surveys.readonly', u'https://www.googleapis.com/auth/userinfo.email', u'https://www.googleapis.com/auth/surveys'], 'version': [u'v2']}, u'identitytoolkit': {'scopes': [u'https://www.googleapis.com/auth/firebase', u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v3']}, u'logging': {'scopes': [u'https://www.googleapis.com/auth/logging.admin', u'https://www.googleapis.com/auth/logging.read', u'https://www.googleapis.com/auth/logging.write', u'https://www.googleapis.com/auth/cloud-platform', u'https://www.googleapis.com/auth/cloud-platform.read-only'], 'version': [u'v2']}, u'language': {'scopes': [u'https://www.googleapis.com/auth/cloud-language', u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1', u'v1beta1', u'v1beta2']}, u'admin': {'scopes': [u'https://www.googleapis.com/auth/admin.datatransfer.readonly', u'https://www.googleapis.com/auth/admin.datatransfer', u'https://www.googleapis.com/auth/admin.directory.user', u'https://www.googleapis.com/auth/admin.directory.domain', u'https://www.googleapis.com/auth/admin.directory.resource.calendar', u'https://www.googleapis.com/auth/admin.directory.group.member.readonly', u'https://www.googleapis.com/auth/admin.directory.device.mobile.readonly', u'https://www.googleapis.com/auth/admin.directory.orgunit.readonly', u'https://www.googleapis.com/auth/admin.directory.group.member', u'https://www.googleapis.com/auth/admin.directory.device.mobile', u'https://www.googleapis.com/auth/admin.directory.user.alias', u'https://www.googleapis.com/auth/admin.directory.device.mobile.action', u'https://www.googleapis.com/auth/admin.directory.device.chromeos', u'https://www.googleapis.com/auth/admin.directory.user.alias.readonly', u'https://www.googleapis.com/auth/admin.directory.userschema.readonly', u'https://www.googleapis.com/auth/admin.directory.resource.calendar.readonly', u'https://www.googleapis.com/auth/admin.directory.domain.readonly', u'https://www.googleapis.com/auth/admin.directory.rolemanagement', u'https://www.googleapis.com/auth/admin.directory.notifications', u'https://www.googleapis.com/auth/admin.directory.customer', u'https://www.googleapis.com/auth/admin.directory.userschema', u'https://www.googleapis.com/auth/admin.directory.device.chromeos.readonly', u'https://www.googleapis.com/auth/admin.directory.rolemanagement.readonly', u'https://www.googleapis.com/auth/admin.directory.user.security', u'https://www.googleapis.com/auth/admin.directory.group.readonly', u'https://www.googleapis.com/auth/admin.directory.customer.readonly', u'https://www.googleapis.com/auth/admin.directory.user.readonly', u'https://www.googleapis.com/auth/admin.directory.group', u'https://www.googleapis.com/auth/admin.directory.orgunit', u'https://www.googleapis.com/auth/admin.reports.usage.readonly', u'https://www.googleapis.com/auth/admin.reports.audit.readonly'], 'version': [u'datatransfer_v1', u'directory_v1', u'reports_v1']}, u'adsensehost': {'scopes': [u'https://www.googleapis.com/auth/adsensehost'], 'version': [u'v4.1']}, u'games': {'scopes': [u'https://www.googleapis.com/auth/games', u'https://www.googleapis.com/auth/drive.appdata'], 'version': [u'v1']}, u'gamesManagement': {'scopes': [u'https://www.googleapis.com/auth/games'], 'version': [u'v1management']}, u'vault': {'scopes': [u'https://www.googleapis.com/auth/ediscovery', u'https://www.googleapis.com/auth/ediscovery.readonly'], 'version': [u'v1']}, u'cloudscheduler': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1', u'v1beta1']}, u'customsearch': {'scopes': [], 'version': [u'v1']}, u'cloudasset': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1', u'v1beta1']}, u'groupsmigration': {'scopes': [u'https://www.googleapis.com/auth/apps.groups.migration'], 'version': [u'v1']}, u'texttospeech': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1', u'v1beta1']}, u'accessapproval': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1beta1']}, u'proximitybeacon': {'scopes': [u'https://www.googleapis.com/auth/userlocation.beacon.registry'], 'version': [u'v1beta1']}, u'blogger': {'scopes': [u'https://www.googleapis.com/auth/blogger', u'https://www.googleapis.com/auth/blogger.readonly'], 'version': [u'v2', u'v3']}, u'poly': {'scopes': [], 'version': [u'v1']}, u'videointelligence': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1p1beta1', u'v1p2beta1', u'v1p3beta1', u'v1', u'v1beta2']}, u'androidpublisher': {'scopes': [u'https://www.googleapis.com/auth/androidpublisher'], 'version': [u'v1', u'v1.1', u'v2', u'v3']}, u'licensing': {'scopes': [u'https://www.googleapis.com/auth/apps.licensing'], 'version': [u'v1']}, u'composer': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1', u'v1beta1']}, u'servicebroker': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1alpha1', u'v1', u'v1beta1']}, u'iam': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1']}, u'genomics': {'scopes': [u'https://www.googleapis.com/auth/compute', u'https://www.googleapis.com/auth/genomics', u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1alpha2', u'v2alpha1', u'v1']}, u'servicecontrol': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform', u'https://www.googleapis.com/auth/servicecontrol'], 'version': [u'v1']}, u'cloudshell': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1alpha1', u'v1']}, u'script': {'scopes': [u'https://www.googleapis.com/auth/drive', u'https://www.google.com/m8/feeds', u'https://www.googleapis.com/auth/forms.currentonly', u'https://www.googleapis.com/auth/admin.directory.user', u'https://www.googleapis.com/auth/documents', u'https://www.googleapis.com/auth/script.processes', u'https://www.googleapis.com/auth/script.projects.readonly', u'https://www.googleapis.com/auth/spreadsheets', u'https://www.googleapis.com/auth/script.metrics', u'https://www.googleapis.com/auth/groups', u'https://mail.google.com/', u'https://www.google.com/calendar/feeds', u'https://www.googleapis.com/auth/admin.directory.group', u'https://www.googleapis.com/auth/script.projects', u'https://www.googleapis.com/auth/forms', u'https://www.googleapis.com/auth/userinfo.email', u'https://www.googleapis.com/auth/script.deployments', u'https://www.googleapis.com/auth/script.deployments.readonly'], 'version': [u'v1']}, u'gamesConfiguration': {'scopes': [u'https://www.googleapis.com/auth/androidpublisher'], 'version': [u'v1configuration']}, u'cloudtrace': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform', u'https://www.googleapis.com/auth/trace.append', u'https://www.googleapis.com/auth/trace.readonly'], 'version': [u'v2alpha1', u'v1', u'v2']}, u'youtubeAnalytics': {'scopes': [u'https://www.googleapis.com/auth/youtube.readonly', u'https://www.googleapis.com/auth/yt-analytics.readonly', u'https://www.googleapis.com/auth/youtube', u'https://www.googleapis.com/auth/youtubepartner', u'https://www.googleapis.com/auth/yt-analytics-monetary.readonly'], 'version': [u'v1', u'v2']}, u'groupssettings': {'scopes': [u'https://www.googleapis.com/auth/apps.groups.settings'], 'version': [u'v1']}, u'cloudkms': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform', u'https://www.googleapis.com/auth/cloudkms'], 'version': [u'v1']}, u'dns': {'scopes': [u'https://www.googleapis.com/auth/ndev.clouddns.readonly', u'https://www.googleapis.com/auth/ndev.clouddns.readwrite', u'https://www.googleapis.com/auth/cloud-platform', u'https://www.googleapis.com/auth/cloud-platform.read-only'], 'version': [u'v1', u'v1beta2', u'v2beta1']}, u'searchconsole': {'scopes': [], 'version': [u'v1']}, u'translate': {'scopes': [u'https://www.googleapis.com/auth/cloud-translation', u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v2']}, u'iap': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1', u'v1beta1']}, u'testing': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform', u'https://www.googleapis.com/auth/cloud-platform.read-only'], 'version': [u'v1']}, u'factchecktools': {'scopes': [u'https://www.googleapis.com/auth/userinfo.email'], 'version': [u'v1alpha1']}, u'manufacturers': {'scopes': [u'https://www.googleapis.com/auth/manufacturercenter'], 'version': [u'v1']}, u'deploymentmanager': {'scopes': [u'https://www.googleapis.com/auth/ndev.cloudman.readonly', u'https://www.googleapis.com/auth/cloud-platform', u'https://www.googleapis.com/auth/ndev.cloudman', u'https://www.googleapis.com/auth/cloud-platform.read-only'], 'version': [u'alpha', u'v2beta', u'v2']}, u'replicapool': {'scopes': [u'https://www.googleapis.com/auth/ndev.cloudman.readonly', u'https://www.googleapis.com/auth/ndev.cloudman', u'https://www.googleapis.com/auth/cloud-platform.read-only', u'https://www.googleapis.com/auth/cloud-platform', u'https://www.googleapis.com/auth/replicapool', u'https://www.googleapis.com/auth/replicapool.readonly'], 'version': [u'v1beta1']}, u'pagespeedonline': {'scopes': [], 'version': [u'v1', u'v2', u'v4', u'v5']}, u'adexchangebuyer': {'scopes': [u'https://www.googleapis.com/auth/adexchange.buyer'], 'version': [u'v1.2', u'v1.3', u'v1.4']}, u'sqladmin': {'scopes': [u'https://www.googleapis.com/auth/sqlservice.admin', u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1beta4']}, u'oauth2': {'scopes': [u'https://www.googleapis.com/auth/userinfo.email', u'https://www.googleapis.com/auth/userinfo.profile', u'https://www.googleapis.com/auth/plus.me'], 'version': [u'v1', u'v2']}, u'compute': {'scopes': [u'https://www.googleapis.com/auth/devstorage.full_control', u'https://www.googleapis.com/auth/devstorage.read_only', u'https://www.googleapis.com/auth/devstorage.read_write', u'https://www.googleapis.com/auth/cloud-platform', u'https://www.googleapis.com/auth/compute', u'https://www.googleapis.com/auth/compute.readonly'], 'version': [u'alpha', u'beta', u'v1']}, u'dataflow': {'scopes': [u'https://www.googleapis.com/auth/compute', u'https://www.googleapis.com/auth/userinfo.email', u'https://www.googleapis.com/auth/cloud-platform', u'https://www.googleapis.com/auth/compute.readonly'], 'version': [u'v1b3']}, u'ml': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1']}, u'adexchangebuyer2': {'scopes': [u'https://www.googleapis.com/auth/adexchange.buyer'], 'version': [u'v2beta1']}, u'doubleclickbidmanager': {'scopes': [u'https://www.googleapis.com/auth/doubleclickbidmanager'], 'version': [u'v1']}, u'sheets': {'scopes': [u'https://www.googleapis.com/auth/drive', u'https://www.googleapis.com/auth/spreadsheets.readonly', u'https://www.googleapis.com/auth/drive.file', u'https://www.googleapis.com/auth/spreadsheets', u'https://www.googleapis.com/auth/drive.readonly'], 'version': [u'v4']}, u'clouderrorreporting': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1beta1']}, u'appengine': {'scopes': [u'https://www.googleapis.com/auth/appengine.admin', u'https://www.googleapis.com/auth/cloud-platform', u'https://www.googleapis.com/auth/cloud-platform.read-only'], 'version': [u'v1alpha', u'v1beta', u'v1', u'v1beta4', u'v1beta5']}, u'iamcredentials': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1']}, u'file': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1', u'v1beta1']}, u'youtube': {'scopes': [u'https://www.googleapis.com/auth/youtubepartner-channel-audit', u'https://www.googleapis.com/auth/youtube', u'https://www.googleapis.com/auth/youtubepartner', u'https://www.googleapis.com/auth/youtube.force-ssl', u'https://www.googleapis.com/auth/youtube.readonly', u'https://www.googleapis.com/auth/youtube.upload'], 'version': [u'v3']}, u'civicinfo': {'scopes': [], 'version': [u'v2']}, u'acceleratedmobilepageurl': {'scopes': [], 'version': [u'v1']}, u'cloudsearch': {'scopes': [u'https://www.googleapis.com/auth/cloud_search.debug', u'https://www.googleapis.com/auth/cloud_search.settings', u'https://www.googleapis.com/auth/cloud_search.stats.indexing', u'https://www.googleapis.com/auth/cloud_search', u'https://www.googleapis.com/auth/cloud_search.settings.query', u'https://www.googleapis.com/auth/cloud_search.indexing', u'https://www.googleapis.com/auth/cloud_search.stats', u'https://www.googleapis.com/auth/cloud_search.query', u'https://www.googleapis.com/auth/cloud_search.settings.indexing'], 'version': [u'v1']}, u'sourcerepo': {'scopes': [u'https://www.googleapis.com/auth/source.full_control', u'https://www.googleapis.com/auth/source.read_only', u'https://www.googleapis.com/auth/cloud-platform', u'https://www.googleapis.com/auth/source.read_write'], 'version': [u'v1']}, u'chat': {'scopes': [], 'version': [u'v1']}, u'cloudfunctions': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1', u'v1beta2']}, u'safebrowsing': {'scopes': [], 'version': [u'v4']}, u'datastore': {'scopes': [u'https://www.googleapis.com/auth/datastore', u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1', u'v1beta1', u'v1beta3']}, u'driveactivity': {'scopes': [u'https://www.googleapis.com/auth/drive.activity', u'https://www.googleapis.com/auth/drive.activity.readonly'], 'version': [u'v2']}, u'cloudprivatecatalog': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1beta1']}, u'clouddebugger': {'scopes': [u'https://www.googleapis.com/auth/cloud_debugger', u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v2']}, u'monitoring': {'scopes': [u'https://www.googleapis.com/auth/monitoring.write', u'https://www.googleapis.com/auth/cloud-platform', u'https://www.googleapis.com/auth/monitoring.read', u'https://www.googleapis.com/auth/monitoring'], 'version': [u'v3p1alpha1', u'v3']}, u'binaryauthorization': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1beta1']}, u'storage': {'scopes': [u'https://www.googleapis.com/auth/devstorage.read_only', u'https://www.googleapis.com/auth/devstorage.read_write', u'https://www.googleapis.com/auth/cloud-platform', u'https://www.googleapis.com/auth/devstorage.full_control', u'https://www.googleapis.com/auth/cloud-platform.read-only'], 'version': [u'v1', u'v1beta1', u'v1beta2']}, u'commentanalyzer': {'scopes': [u'https://www.googleapis.com/auth/userinfo.email'], 'version': [u'v1alpha1']}, u'cloudbuild': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1alpha1', u'v1']}, u'speech': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1p1beta1', u'v1']}, u'plus': {'scopes': [u'https://www.googleapis.com/auth/plus.login', u'https://www.googleapis.com/auth/userinfo.email', u'https://www.googleapis.com/auth/userinfo.profile', u'https://www.googleapis.com/auth/plus.me'], 'version': [u'v1']}, u'serviceusage': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform', u'https://www.googleapis.com/auth/service.management', u'https://www.googleapis.com/auth/cloud-platform.read-only'], 'version': [u'v1', u'v1beta1']}, u'urlshortener': {'scopes': [u'https://www.googleapis.com/auth/urlshortener'], 'version': [u'v1']}, u'doubleclicksearch': {'scopes': [u'https://www.googleapis.com/auth/doubleclicksearch'], 'version': [u'v2']}, u'fusiontables': {'scopes': [u'https://www.googleapis.com/auth/fusiontables', u'https://www.googleapis.com/auth/fusiontables.readonly'], 'version': [u'v1', u'v2']}, u'plusDomains': {'scopes': [u'https://www.googleapis.com/auth/plus.login', u'https://www.googleapis.com/auth/userinfo.profile', u'https://www.googleapis.com/auth/plus.stream.read', u'https://www.googleapis.com/auth/plus.circles.read', u'https://www.googleapis.com/auth/plus.profiles.read', u'https://www.googleapis.com/auth/userinfo.email', u'https://www.googleapis.com/auth/plus.media.upload', u'https://www.googleapis.com/auth/plus.me'], 'version': [u'v1']}, u'dataproc': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1', u'v1beta2']}, u'bigquery': {'scopes': [u'https://www.googleapis.com/auth/devstorage.full_control', u'https://www.googleapis.com/auth/cloud-platform.read-only', u'https://www.googleapis.com/auth/devstorage.read_only', u'https://www.googleapis.com/auth/devstorage.read_write', u'https://www.googleapis.com/auth/cloud-platform', u'https://www.googleapis.com/auth/bigquery.insertdata', u'https://www.googleapis.com/auth/bigquery'], 'version': [u'v2']}, u'containeranalysis': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1alpha1', u'v1beta1']}, u'datafusion': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1beta1']}, u'securitycenter': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1', u'v1beta1']}, u'appsactivity': {'scopes': [u'https://www.googleapis.com/auth/activity'], 'version': [u'v1']}, u'fcm': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1']}, u'adexperiencereport': {'scopes': [u'https://www.googleapis.com/auth/xapi.zoo'], 'version': [u'v1']}, u'classroom': {'scopes': [u'https://www.googleapis.com/auth/classroom.guardianlinks.students.readonly', u'https://www.googleapis.com/auth/classroom.student-submissions.me.readonly', u'https://www.googleapis.com/auth/classroom.guardianlinks.students', u'https://www.googleapis.com/auth/classroom.coursework.me.readonly', u'https://www.googleapis.com/auth/classroom.coursework.students.readonly', u'https://www.googleapis.com/auth/classroom.push-notifications', u'https://www.googleapis.com/auth/classroom.courses', u'https://www.googleapis.com/auth/classroom.student-submissions.students.readonly', u'https://www.googleapis.com/auth/classroom.rosters', u'https://www.googleapis.com/auth/classroom.profile.emails', u'https://www.googleapis.com/auth/classroom.profile.photos', u'https://www.googleapis.com/auth/classroom.coursework.students', u'https://www.googleapis.com/auth/classroom.announcements.readonly', u'https://www.googleapis.com/auth/classroom.courses.readonly', u'https://www.googleapis.com/auth/classroom.coursework.me', u'https://www.googleapis.com/auth/classroom.rosters.readonly', u'https://www.googleapis.com/auth/classroom.announcements', u'https://www.googleapis.com/auth/classroom.guardianlinks.me.readonly', u'https://www.googleapis.com/auth/classroom.topics', u'https://www.googleapis.com/auth/classroom.topics.readonly'], 'version': [u'v1']}, u'slides': {'scopes': [u'https://www.googleapis.com/auth/drive', u'https://www.googleapis.com/auth/spreadsheets', u'https://www.googleapis.com/auth/presentations', u'https://www.googleapis.com/auth/presentations.readonly', u'https://www.googleapis.com/auth/drive.file', u'https://www.googleapis.com/auth/spreadsheets.readonly', u'https://www.googleapis.com/auth/drive.readonly'], 'version': [u'v1']}, u'reseller': {'scopes': [u'https://www.googleapis.com/auth/apps.order', u'https://www.googleapis.com/auth/apps.order.readonly'], 'version': [u'v1']}, u'analyticsreporting': {'scopes': [u'https://www.googleapis.com/auth/analytics', u'https://www.googleapis.com/auth/analytics.readonly'], 'version': [u'v4']}, u'storagetransfer': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1']}, u'toolresults': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1beta3']}, u'webfonts': {'scopes': [], 'version': [u'v1']}, u'drive': {'scopes': [u'https://www.googleapis.com/auth/drive', u'https://www.googleapis.com/auth/drive.apps.readonly', u'https://www.googleapis.com/auth/drive.photos.readonly', u'https://www.googleapis.com/auth/drive.metadata', u'https://www.googleapis.com/auth/drive.readonly', u'https://www.googleapis.com/auth/drive.file', u'https://www.googleapis.com/auth/drive.scripts', u'https://www.googleapis.com/auth/drive.metadata.readonly', u'https://www.googleapis.com/auth/drive.appdata'], 'version': [u'v2', u'v3']}, u'tagmanager': {'scopes': [u'https://www.googleapis.com/auth/tagmanager.readonly', u'https://www.googleapis.com/auth/tagmanager.delete.containers', u'https://www.googleapis.com/auth/tagmanager.edit.containerversions', u'https://www.googleapis.com/auth/tagmanager.manage.users', u'https://www.googleapis.com/auth/tagmanager.publish', u'https://www.googleapis.com/auth/tagmanager.edit.containers', u'https://www.googleapis.com/auth/tagmanager.manage.accounts'], 'version': [u'v1', u'v2']}, u'tpu': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1alpha1', u'v1']}, u'servicenetworking': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform', u'https://www.googleapis.com/auth/service.management'], 'version': [u'v1beta', u'v1']}, u'healthcare': {'scopes': [u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1alpha2', u'v1beta1']}, u'androiddeviceprovisioning': {'scopes': [], 'version': [u'v1']}, u'cloudprofiler': {'scopes': [u'https://www.googleapis.com/auth/monitoring.write', u'https://www.googleapis.com/auth/cloud-platform', u'https://www.googleapis.com/auth/monitoring'], 'version': [u'v2']}, u'firestore': {'scopes': [u'https://www.googleapis.com/auth/datastore', u'https://www.googleapis.com/auth/cloud-platform'], 'version': [u'v1', u'v1beta1', u'v1beta2']}}
c={}
#filter out only cloud related services 
for i in d:
    for j in d[i]["scopes"]:
        if "cloud-platform" in j:
            #print i
            c[i]={}
            c[i]["version"]=d[i]["version"]
            c[i]["scopes"]=d[i]["scopes"]
            pass
#print c
result=c.keys()
sorted(result)
#print result

#Start Time of Script
starttime=datetime.utcnow()

pprint.pprint("Start Time(UTC): " + str(starttime))

if args.logs == True:
    filename="logs-"+str(starttime.strftime('%d-%B-%Y-%H-%M-%S'))
    f=open(filename, 'w+')
#Add start time to log file
if args.logs == True:
    f.write("Start Time(UTC): " + str(starttime)+"\n")

#Get Projects related data
response = requests.get("https://www.googleapis.com/oauth2/v1/tokeninfo?access_token="+args.access_token, headers=headers)
response=response.json()
#print response
if "invalid_token" in str(response):
    pprint.pprint("Expired token. Exiting!!!")
    sys.exit()
else:    
    if args.project_id:
        projectid=args.project_id
    else:
        try:
            projectid=response['email'].split("@")[0]
        except:
            pprint.pprint("Not able to fetch projectID, please provide it through --project-id")
    #projectid="adsasdas"
    #print projectid
    scopes=response['scope'].split(" ")
    #print scopes
    pprint.pprint("Below is list of possible services above token can have access to: \n")
servicelist=[]
for i in c:
    notinscope=False
    for j in c[i]["scopes"]:
        if j not in scopes:
            notinscope=True
    if notinscope==False:
        servicelist.append(str(i))
pprint.pprint(", ".join(servicelist))
pprint.pprint("Now enumerating above all services")
resource="projects/"+projectid
credentials = google.oauth2.credentials.Credentials(args.access_token)
regions=["northamerica-northeast1","us-central1","us-west2","us-east1","us-east4","southamerica-east1","europe-west","europe-west3","europe-west2","europe-west6","asia-northeast1","asia-northeast2","asia-east2","asia-south1","australia-southeast1"]
zones=[u"us-east1-b", u"us-east1-c", u"us-east1-d", u"us-east4-c", u"us-east4-b", u"us-east4-a", u"us-central1-c", u"us-central1-a", u"us-central1-f", u"us-central1-b", u"us-west1-b", u"us-west1-c", u"us-west1-a", u"europe-west4-a", u"europe-west4-b", u"europe-west4-c", u"europe-west1-b", u"europe-west1-d", u"europe-west1-c", u"europe-west3-c", u"europe-west3-a", u"europe-west3-b", u"europe-west2-c", u"europe-west2-b", u"europe-west2-a", u"asia-east1-b", u"asia-east1-a", u"asia-east1-c", u"asia-southeast1-b", u"asia-southeast1-a", u"asia-southeast1-c", u"asia-northeast1-b", u"asia-northeast1-c", u"asia-northeast1-a", u"asia-south1-c", u"asia-south1-b", u"asia-south1-a", u"australia-southeast1-b", u"australia-southeast1-c", u"australia-southeast1-a", u"southamerica-east1-b", u"southamerica-east1-c", u"southamerica-east1-a", u"asia-east2-a", u"asia-east2-b", u"asia-east2-c", u"asia-northeast2-a", u"asia-northeast2-b", u"asia-northeast2-c", u"europe-north1-a", u"europe-north1-b", u"europe-north1-c", u"europe-west6-a", u"europe-west6-b", u"europe-west6-c", u"northamerica-northeast1-a", u"northamerica-northeast1-b", u"northamerica-northeast1-c", u"us-west2-a", u"us-west2-b", u"us-west2-c"]


gcpfunctions={"cloudfunctions.operations.list":{"parameter":'filter="project:"+projectid+",latest:true"',"version":'v1',"regionRequired":'False'},"cloudfunctions.projects.locations.functions.list":{"parameter":'parent="projects/"+projectid+"/locations/"+locationId',"version":'v1',"regionRequired":'True'},"cloudbilling.billingAccounts.list":{"parameter":'',"version":"v1","regionRequired":'False'},"cloudbilling.services.list":{"parameter":'',"version":"v1","regionRequired":'False'},"storagetransfer.transferJobs.list":{"parameter":'',"version":"v1","regionRequired":'False'},"cloudbuild.operations.list":{"parameter":'name="projects/"+projectid',"version":"v1","regionRequired":'False'},"tpu.projects.locations.list":{"parameter":'',"version":"v1","regionRequired":'False'},"cloudresourcemanager.projects.list":{"parameter":'',"version":"v1","regionRequired":'False'},"cloudresourcemanager.projects.listOrgPolicies":{"parameter":'',"version":"v1","regionRequired":'False'},"cloudresourcemanager.projects.listAvailableOrgPolicies":{"parameter":'',"version":"v1","regionRequired":'False'},"bigquery.datasets.list":{"parameter":'projectId=projectid',"version":"v2","regionRequired":'False'},"bigquery.jobs.list":{"parameter":'projectId=projectid',"version":"v2","regionRequired":'False'},"bigquery.projects.list":{"parameter":'',"version":"v2","regionRequired":'False'},"bigquerydatatransfer.projects.dataSources.list":{"parameter":'parent="projects/"+projectid',"version":"v1","regionRequired":'False'},"bigquerydatatransfer.projects.transferConfigs.list":{"parameter":'parent="projects/"+projectid',"version":"v1","regionRequired":'False'},"bigtableadmin.projects.instances.list":{"parameter":'parent="projects/"+projectid',"version":"v2","regionRequired":'False'},"binaryauthorization.projects.attestors.list":{"parameter":'parent="projects/"+projectid',"version":"v1beta1","regionRequired":'False'},"cloudasset.batchGetAssetsHistory":{"parameter":'parent="projects/"+projectid',"version":"v1","regionRequired":'False'},"cloudbuild.projects.build.list":{"parameter":'projecId=projectid',"version":"v1","regionRequired":'False'},"clouddebugger.debugger.debuggees.list":{"parameter":'projecId=projectid',"version":"v2","regionRequired":'False'},"clouderrorreporting.projects.events.list":{"parameter":'projectName="projects/"+projectid',"version":"v1beta1","regionRequired":'False'},"clouderrorreporting.projects.groupStats.list":{"parameter":'projectName="projects/"+projectid',"version":"v1beta1","regionRequired":'False'},"cloudprivatecatalogproduce.catalogs.list":{"parameter":'',"version":"v1beta1","regionRequired":'False'},"cloudresourcemanager.folders.list":{"parameter":'',"version":"v2","regionRequired":'False'},"containeranalysis.projects.notes.list":{"parameter":'parent="projects/"+projectid',"version":"v1alpha1","regionRequired":'False'},"containeranalysis.projects.occurrences.list":{"parameter":'parent="projects/"+projectid',"version":"v1alpha1","regionRequired":'False'},"dataflow.projects.jobs.list":{"parameter":'projectId=projectid',"version":"v1b3","regionRequired":'False'},"dataflow.projects.snapshots.list":{"parameter":'projecId=projectid',"version":"v1","regionRequired":'False'},"datastore.projects.indexes.list":{"parameter":'projecId=projectid',"version":"v1","regionRequired":'False'},"deploymentmanager.deployments.list":{"parameter":'project=projectid',"version":"v2","regionRequired":'False'},"deploymentmanager.operations.list":{"parameter":'project=projectid',"version":"v2","regionRequired":'False'},"dlp.infoTypes.list":{"parameter":'',"version":"v2","regionRequired":'False'},"dlp.projects.dlpJobs.list":{"parameter":'parent="projects/"+projectid',"version":"v2","regionRequired":'False'},"dlp.projects.triggers.list":{"parameter":'parent="projects/"+projectid',"version":"v2","regionRequired":'False'},"firebaserules.projects.releases.list":{"parameter":'name="projects/"+projectid',"version":"v1","regionRequired":'False'},"genomics.operations.list":{"parameter":'name="projects/"+projectid',"version":"v1","regionRequired":'False'},"storage.buckets.list":{"parameter":'project=projectid',"version":'v1',"regionRequired":'False'},"spanner.projects.instanceConfigs.list":{"parameter":'parent="projects/"+projectid',"version":'v1',"regionRequired":'False'},"spanner.projects.instances.list":{"parameter":'parent="projects/"+projectid',"version":'v1',"regionRequired":'False'},"sourcerepo.projects.repos.list":{"parameter":'name="projects/"+projectid',"version":'v1',"regionRequired":'False'},"serviceusage.services.list":{"parameter":'parent="projects/"+projectno,filter="state:ENABLED"',"version":'v1',"regionRequired":'False'},"servicemanagement.services.list":{"parameter":'consumerId="project:"+projectid',"version":'v1',"regionRequired":'False'},"runtimeconfig.projects.configs.list":{"parameter":'parent="projects/"+projectid',"version":'v1beta1',"regionRequired":'False'},"redis.projects.locations.instances.list":{"parameter":'parent="projects/"+projectid+"/locations/"+locationId',"version":'v1',"regionRequired":'True'},"pubsub.projects.snapshots.list":{"parameter":'project="projects/"+projectid',"version":'v1',"regionRequired":'False'},"pubsub.projects.subscriptions.list":{"parameter":'project="projects/"+projectid',"version":'v1',"regionRequired":'False'},"pubsub.projects.topics.list":{"parameter":'project="projects/"+projectid',"version":'v1',"regionRequired":'False'},"monitoring.projects.alertPolicies.list":{"parameter":'name="projects/"+projectid',"version":'v3',"regionRequired":'False'},"monitoring.projects.groups.list":{"parameter":'name="projects/"+projectid',"version":'v3',"regionRequired":'False'},"monitoring.projects.metricDescriptors.list":{"parameter":'name="projects/"+projectid',"version":'v3',"regionRequired":'False'},"monitoring.projects.notificationChannelDescriptors.list":{"parameter":'name="projects/"+projectid',"version":'v3',"regionRequired":'False'},"monitoring.projects.notificationChannels.list":{"parameter":'name="projects/"+projectid',"version":'v3',"regionRequired":'False'},"monitoring.projects.timeSeries.list":{"parameter":'name="projects/"+projectid',"version":'v3',"regionRequired":'False'},"monitoring.projects.uptimeCheckConfigs.list":{"parameter":'parent="projects/"+projectid',"version":'v3',"regionRequired":'False'},"monitoring.projects.uptimeCheckIps.list":{"parameter":'',"version":'v3',"regionRequired":'False'},"ml.projects.jobs.list":{"parameter":'parent="projects/"+projectid',"version":'v1',"regionRequired":'False'},"ml.projects.locations.list":{"parameter":'parent="projects/"+projectid',"version":'v1',"regionRequired":'False'},"ml.projects.models.list":{"parameter":'parent="projects/"+projectid',"version":'v1',"regionRequired":'False'},"ml.projects.operations.list":{"parameter":'name="projects/"+projectid',"version":'v1',"regionRequired":'False'},"logging.exclusions.list":{"parameter":'parent="projects/"+projectid',"version":'v2',"regionRequired":'False'},"logging.logs.list":{"parameter":'parent="projects/"+projectid',"version":'v2',"regionRequired":'False'},"jobs.projects.companies.list":{"parameter":'parent="projects/"+projectid',"version":'v3',"regionRequired":'False'},"jobs.projects.jobs.list":{"parameter":'parent="projects/"+projectid',"version":'v3',"regionRequired":'False'},"iam.projects.roles.list":{"parameter":'parent="projects/"+projectid',"version":'v1',"regionRequired":'False'},"iam.projects.serviceAccounts.list":{"parameter":'name="projects/"+projectid',"version":'v1',"regionRequired":'False'},"toolresults.projects.histories.list":{"parameter":'projectId=projectid',"version":'v1beta3',"regionRequired":'False'},"websecurityscanner.projects.scanConfigs.list":{"parameter":'parent="projects/"+projectid',"version":'v1alpha',"regionRequired":'False'},"compute.images.list":{"parameter":'project=projectid',"version":'v1',"regionRequired":'False'},"compute.zones.list":{"parameter":'project=projectid',"version":'v1',"regionRequired":'False'},"compute.urlMaps.list":{"parameter":'project=projectid',"version":'v1',"regionRequired":'False'},"compute.backendBuckets.list":{"parameter":'project=projectid',"version":'v1',"regionRequired":'False'},"compute.httpHealthChecks.list":{"parameter":'project=projectid',"version":'v1',"regionRequired":'False'},"compute.firewalls.list":{"parameter":'project=projectid',"version":'v1',"regionRequired":'False'},"compute.globalAddresses.list":{"parameter":'project=projectid',"version":'v1',"regionRequired":'False'},"compute.globalForwardingRules.list":{"parameter":'project=projectid',"version":'v1',"regionRequired":'False'},"compute.globalOperations.list":{"parameter":'project=projectid',"version":'v1',"regionRequired":'False'},"compute.healthChecks.list":{"parameter":'project=projectid',"version":'v1',"regionRequired":'False'},"compute.instanceGroupManagers.aggregatedList":{"parameter":'project=projectid',"version":'v1',"regionRequired":'False'},"compute.networks.list":{"parameter":'project=projectid',"version":'v1',"regionRequired":'False'},"compute.projects.listXpnHosts":{"parameter":'project=projectid',"version":'v1',"regionRequired":'False'},"compute.vpnTunnels.list":{"parameter":'project=projectid,region=regionId',"version":"v1","regionRequired":"True"},"compute.nodeGroups.list":{"parameter":'project=projectid,zone=zoneId',"version":"v1","regionRequired":"False","zoneRequired":"True"},"compute.nodeTemplates.list":{"parameter":'project=projectid,zone=zoneId',"version":"v1","regionRequired":"False","zoneRequired":"True"},"compute.nodeTypes.list":{"parameter":'project=projectid,zone=zoneId',"version":"v1","regionRequired":"False","zoneRequired":"True"},"compute.targetVpnGateways.list":{"parameter":'project=projectid,region=regionId',"version":"v1","regionRequired":"True"},"compute.acceleratorTypes.list":{"parameter":'project=projectid,zone=zoneId',"version":"v1","regionRequired":"False","zoneRequired":"True"}," compute.addresses.list":{"parameter":'project=projectid,region=regionId',"version":"v1","regionRequired":"True"},"compute.autoscalers.list":{"parameter":'project=projectid,zone=zoneId',"version":"v1","regionRequired":"False","zoneRequired":"True"},"compute.backendBuckets.list":{"parameter":'project=projectid',"version":'v1',"regionRequired":'False'},"compute.backendServices.list":{"parameter":'project=projectid',"version":'v1',"regionRequired":'False'},"compute.diskTypes.list":{"parameter":'project=projectid,zone=zoneId',"version":"v1","regionRequired":"False","zoneRequired":"True"},"compute.disks.list":{"parameter":'project=projectid,zone=zoneId',"version":"v1","regionRequired":"False","zoneRequired":"True"},"compute.instances.list":{"parameter":'project=projectid,zone=zoneId',"version":"v1","regionRequired":"False","zoneRequired":"True"},"compute.interconnectAttachments.list":{"parameter":'project=projectid,region=regionId',"version":"v1","regionRequired":"True"},"compute.interconnects.list":{"parameter":'project=projectid',"version":'v1',"regionRequired":'False'},"compute.licenses.list":{"parameter":'project=projectid',"version":'v1',"regionRequired":'False'},"compute.networks.list":{"parameter":'project=projectid',"version":'v1',"regionRequired":'False'},"compute.resourcePolicies.list":{"parameter":'project=projectid,region=regionId',"version":"v1","regionRequired":"True"},"compute.routers.list":{"parameter":'project=projectid,region=regionId',"version":"v1","regionRequired":"True"},"compute.reservations.list":{"parameter":'project=projectid,zone=zoneId',"version":"v1","regionRequired":"False","zoneRequired":"True"},"compute.securityPolicies.list":{"parameter":'project=projectid',"version":'v1',"regionRequired":'False'},"compute.snapshots.list":{"parameter":'project=projectid',"version":'v1',"regionRequired":'False'},"compute.sslCertificates.list":{"parameter":'project=projectid',"version":'v1',"regionRequired":'False'},"compute.sslPolicies.list":{"parameter":'project=projectid',"version":'v1',"regionRequired":'False'}}

for key in gcpfunctions:
    #print key
    #print gcpfunctions[key]["version"]
    #print gcpfunctions[key]["regionRequired"]
    #print gcpfunctions[key]["parameter"]
    
    if gcpfunctions[key]["regionRequired"]=="True":
        if args.region:
            try:
                keys=key.split(".")
                #print keys[0]
                joinedvalue="().".join(keys[1:-1])
                #print joinedvalue
                service = build(keys[0],gcpfunctions[key]["version"], credentials=credentials)
                parametervalue=gcpfunctions[key]["parameter"]
                #print args.region
                if "locationId" in parametervalue:
                    parametervalue=parametervalue.replace('"+locationId',args.region+'"')
                elif "regionId" in parametervalue:
                    parametervalue=parametervalue.replace('regionId','"'+args.region+'"')
                #print parametervalue
                joinedvalue="service."+joinedvalue+"()."+keys[-1]+"("+parametervalue+").execute"
                #print joinedvalue
                method_to_call=eval(joinedvalue)
                response = method_to_call()
                print(colored("Output of "+key+" for region: "+args.region+"\n",'green',attrs=['dark']))
                pprint.pprint(response)
                if args.logs==True:
                    f.write("Output of "+key+" for region: "+args.region+"\n")
                    pprint.pprint(response,f)
            except:
                if args.verbose:
                    print(colored("Access Denied: "+key+" for region: "+args.region+"\n",'red',attrs=['dark']))
                    if args.logs==True:
                        f.write("Access Denied: "+key+" for region: "+args.region+"\n")
        else:        
            for region in regions:
                try:
                    keys=key.split(".")
                    #print keys[0]
                    joinedvalue="().".join(keys[1:-1])
                    #print joinedvalue
                    service = build(keys[0],gcpfunctions[key]["version"], credentials=credentials)
                    parametervalue=gcpfunctions[key]["parameter"]
                    #print region
                    if "locationId" in parametervalue:
                        parametervalue=parametervalue.replace('"+locationId',region+'"')
                    elif "regionId" in parametervalue:
                        parametervalue=parametervalue.replace('regionId','"'+region+'"')
                    #print parametervalue
                    joinedvalue="service."+joinedvalue+"()."+keys[-1]+"("+parametervalue+").execute"
                    #print joinedvalue
                    method_to_call=eval(joinedvalue)
                    response = method_to_call()
                    print(colored("Output of "+key+" for region: "+region+"\n",'green',attrs=['dark']))
                    pprint.pprint(response)
                    if args.logs==True:
                        f.write("Output of "+key+" for region: "+region+"\n")
                        pprint.pprint(response,f)
                except Exception as e:
                    #print e
                    if args.verbose:
                        print(colored("Access Denied: "+key+" for region: "+region+"\n",'red',attrs=['dark']))
                        if args.logs==True:
                            f.write("Access Denied: "+key+" for region: "+region+"\n")
    elif "zoneRequired" in gcpfunctions[key]:
    #elif gcpfunctions[key]["zoneRequired"]=="True":
        for zone in zones:
            try:
                keys=key.split(".")
                #print keys[0]
                joinedvalue="().".join(keys[1:-1])
                #print joinedvalue
                service = build(keys[0],gcpfunctions[key]["version"], credentials=credentials)
                parametervalue=gcpfunctions[key]["parameter"]
                #print zone
                parametervalue=parametervalue.replace('zoneId','"'+zone+'"')
                #print parametervalue
                joinedvalue="service."+joinedvalue+"()."+keys[-1]+"("+parametervalue+").execute"
                #print joinedvalue
                method_to_call=eval(joinedvalue)
                response = method_to_call()
                print(colored("Output of "+key+" for zone: "+zone+"\n",'green',attrs=['dark']))
                pprint.pprint(response)
                if args.logs==True:
                    f.write("Output of "+key+" for zone: "+zone+"\n")
                    pprint.pprint(response,f)
            except Exception as e:
                #print e
                if args.verbose:
                    print(colored("Access Denied: "+key+" for zone: "+zone+"\n",'red',attrs=['dark']))
                    if args.logs==True:
                        f.write("Access Denied: "+key+" for zone: "+zone+"\n")                             
    else:
        try:
            keys=key.split(".")
            #print keys[0]
            joinedvalue="().".join(keys[1:-1])
            #print joinedvalue
            #print projectid
            service = build(keys[0],gcpfunctions[key]["version"], credentials=credentials)
            parametervalue=gcpfunctions[key]["parameter"]
            #print parametervalue
            joinedvalue="service."+joinedvalue+"()."+keys[-1]+"("+parametervalue+").execute"
            #print joinedvalue
            method_to_call=eval(joinedvalue)
            response = method_to_call()
            print(colored("Output of "+key+"\n",'green',attrs=['dark']))
            pprint.pprint(response)
            if args.logs==True:
                f.write("Output of"+key+"\n")
                pprint.pprint(response,f)
        except:
            if args.verbose:
                print(colored("Access Denied: "+key+"\n",'red',attrs=['dark']))
                if args.logs==True:
                    f.write("Access Denied: "+key+"\n")        
endtime=str(datetime.utcnow())
pprint.pprint("End Time(UTC): " + endtime)
if args.logs==True:
    f.write("End Time(UTC): " + endtime+"\n")
    f.close()
#End Time of script
